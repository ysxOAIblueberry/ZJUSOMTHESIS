\newcommand{\FakeBoldSize}{2.5}

% NOTE:
%   To use LuaTeX, we manually set the AutoFakeBold size for each font,
%   because in LuaTeX, CTeX invokes luatexja which does not recognize a global
%   AutoFakeBold setting. So we need to set AutoFakeBold for each font.

% ctex package stores one of "windows", "mac", and "fandol" in \g__ctex_fontset_tl
\ifthenelse{\equal{\csname g__ctex_fontset_tl\endcsname}{mac}}
{
\IfFileExists{ /System/Library/Fonts/PingFang.ttc }
{
    % MacOS El Capitan and later version
    % https://github.com/CTeX-org/ctex-kit/issues/351

    % Fonts
    %   Fix songti font invocation in `ctex` package on MacOS old version, to enable bold font
    %   Detailes in: https://github.com/TheNetAdmin/zjuthesis/issues/48
    %   Similar implementation: https://github.com/xueruini/thuthesis/blob/a86b0824da527268645571cc5fe3096d65a665b3/thuthesis.dtx#L1447-L1461
    \setCJKfamilyfont{zhfs}   {STFangsong}      [AutoFakeBold={\FakeBoldSize}]
    \setCJKfamilyfont{zhhei}  {Heiti SC Light}  [BoldFont={Heiti SC Medium}]
    \setCJKfamilyfont{zhkai}  {Kaiti SC}        [BoldFont={Kaiti SC Bold}]
    \setCJKfamilyfont{zhsong} {Songti SC Light} [BoldFont={Songti SC Bold}]
    
    \setCJKmainfont[AutoFakeBold={\FakeBoldSize}]{STFangsong}
}
{
    % Older MacOS
    % Fonts
    \setCJKfamilyfont{zhfs}   {STFangsong} [AutoFakeBold={\FakeBoldSize}]
    \setCJKfamilyfont{zhhei}  {STHeiti}    [AutoFakeBold={\FakeBoldSize}]
    \setCJKfamilyfont{zhkai}  {STKaiti}    [AutoFakeBold={\FakeBoldSize}]
    \setCJKfamilyfont{zhsong} {STSong}     [AutoFakeBold={\FakeBoldSize}]

    \setCJKmainfont[AutoFakeBold={\FakeBoldSize}]{STFangsong}
}
}
{
    % Windows or other platform
    \defaultfontfeatures{Path = fonts/}
    
    % 仿宋 (SimFang)
    \setCJKfamilyfont{zhfs} {simfang.ttf} [AutoFakeBold={\FakeBoldSize}]
    
    % 黑体 (SimHei)
    \setCJKfamilyfont{zhhei} {simhei.ttf} [AutoFakeBold={\FakeBoldSize}]
    
    % 楷体 (KaiTi)
    \setCJKfamilyfont{zhkai} {simkai.ttf} [AutoFakeBold={\FakeBoldSize}]
    
    % 宋体 (SimSun)
    \setCJKfamilyfont{zhsong} {simsun.ttc} [AutoFakeBold={\FakeBoldSize}]
    
    % 华文仿宋 (STFangsong)
    \setCJKfamilyfont{hwfs} {STFangsong.TTF} [AutoFakeBold={\FakeBoldSize}]
    
    % 华文行楷 (STXingkai)
    \setCJKfamilyfont{xingkai} {STXingkai.TTF} [AutoFakeBold={\FakeBoldSize}]
    
    % 仿宋_GB2312 (FangSong_GB2312)
    \setCJKfamilyfont{zhfsgb} {FangSong_GB2312.ttf} [AutoFakeBold={\FakeBoldSize}]

    \setCJKmainfont[AutoFakeBold={\FakeBoldSize}]{simfang.ttf}

    % =============================================================
    % 系统导入字体
    % \setCJKfamilyfont{zhfs}   {FangSong} [AutoFakeBold={\FakeBoldSize}]
    % \setCJKfamilyfont{zhhei}  {SimHei}   [AutoFakeBold={\FakeBoldSize}]
    % \setCJKfamilyfont{zhkai}  {KaiTi}    [AutoFakeBold={\FakeBoldSize}]
    % \setCJKfamilyfont{zhsong} {SimSun}   [AutoFakeBold={\FakeBoldSize}]
    % \setCJKfamilyfont{hwfs} {STFangsong} [AutoFakeBold={\FakeBoldSize}]
    % \setCJKfamilyfont{xingkai} {STXingkai} [AutoFakeBold={\FakeBoldSize}]
    % \setCJKfamilyfont{zhfsgb} {FangSong_GB2312} [AutoFakeBold={\FakeBoldSize}]

    % \setCJKmainfont[AutoFakeBold={\FakeBoldSize}]{FangSong}
    % =============================================================
}

\setmainfont{times.ttf}[
    Path = fonts/,
    BoldFont = timesbd.ttf,
    ItalicFont = timesi.ttf,
    BoldItalicFont = timesbi.ttf
]
% \setmainfont{Times New Roman}
\newcommand{\huawenfangsong}{\CJKfamily{hwfs}}
\newcommand{\huawenxingkai}{\CJKfamily{xingkai}}
\newcommand{\fangsonggb}{\CJKfamily{zhfsgb}}
